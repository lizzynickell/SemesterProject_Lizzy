---
title: Wild Boar are from Mars
subtitle: Do males move more than females?
author: Lizzy Nickell
output: html_document
---

```{r Chunk 0, message=FALSE, warning=FALSE, include=FALSE}
#Housekeeping:

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

#Please load the following Libraries:
library(ComputationalMovementAnalysisData)
library(sf)
library(tidyverse)
library(psych)
library(ggpubr)
library(dplyr)
library(tmap)
```

## Abstract

There are many physical and behavioral differences between male and female wild boars. Females are typically smaller, and stay together in herds with other females and young. Males, on the other hand, wander larger territories, avoiding other males, and only interacting with females during mating season. We wanted to know if this difference in behavior is noticeable in their movement patterns. Using current data and multiple methods, we have found no differences in the movement patterns. While they may act differently, one sex does not move more than the other.

## Introduction

The wild boar (Sus scrofa) is a highly adaptable species native to Europe and Asia and introduced to North America. They are highly invasive in North America, and considered pests in most of Europe and Asia. As such, numerous projects have been put in place to track the movements of wild boar and monitor efforts to repel them from croplands.

Wild boars are a dimorphic species. Males are 20% larger than females, and are solitary for the majority of the year (Wickline, 2014). Females travel in herds anywhere from 6 to 100 individuals with piglets, juveniles, and males up to 2 years old (Wickline, 2014). Females protect offspring, sometimes leaving piglets with a single female while others go off to forage. It has been estimated that homeranges for females are 500-1,000 ha, while males have a homerange of 1,000-2,000 ha (Kueling and Leus, 2019).

Nineteen wild boar were tagged and monitored between the years of 2014 and 2016. Six of the boars were adult males, and the rest were adult females. Two main site locations were determeined by looking at the center of the the pig's locations: Bern and Aargau. Some of the pigs were captured multiple times and given new collars, but their ID was kept the same. Depending on the pig, and time of year, locations were taken at different sampling ratios. Pigs with enough data were used for this analysis.

```{r Chunk 1, include=FALSE}
#load data
pigs <- wildschwein_BE
metapigs <- wildschwein_metadata
pigs <- pigs %>%
  full_join(metapigs, by = "TierID",copy = F)
head(pigs)
write.csv(pigs, file = "pigs.csv")

 #sort data: min/max E & N
pigs2 <- read.csv("~/Documents/cma_project/SemesterProject_Lizzy/pigs2.csv")

  #Make data sf
pigs2 <- st_as_sf(pigs2, 
                          coords = c("E", "N"), 
                          crs = 2056,
                          remove = FALSE)

pigs2grouped <- group_by(pigs2,TierID)
pigs2smry <- summarise(pigs2grouped)
```

## Material and Methods

Nineteen wild boar were tagged and monitored between the years of 2014 and 2016. Six of the boars were adult males, and the rest were adult females. Two main site locations were determeined by looking at the center of the the pig's locations: Bern and Aargau. Some of the pigs were captured multiple times and given new collars, but their ID was kept the same. Depending on the pig, and time of year, locations were taken at different sampling ratios. Pigs with enough data were used for this analysis.

Two methods were used to analyze the motion of the pigs and compare them by sex. The first was a traditional bounding box method, taking the extreme coordinates in each direction and creating a box from those coordinates (fig 1). The area of each box was calculated, then the averages for each sex were calculated.

```{r Chunk 2}
  #Isolate piggies
pig1 <- mcp %>% filter(TierID == 1)
pig2 <- mcp %>% filter(TierID == 2)
pig5 <- mcp %>% filter(TierID == 5)
pig10 <- mcp %>% filter(TierID == 10)
pig11 <- mcp %>% filter(TierID == 11)
pig16 <- mcp %>% filter(TierID == 16)
pig18 <- mcp %>% filter(TierID == 18)
pig22 <- mcp %>% filter(TierID == 22)
pig25 <- mcp %>% filter(TierID == 25)
pig31 <- mcp %>% filter(TierID == 31)
pig36 <- mcp %>% filter(TierID == 36)
pig40 <- mcp %>% filter(TierID == 40)
pig48 <- mcp %>% filter(TierID == 48)
pig60 <- mcp %>% filter(TierID == 60)
pig83 <- mcp %>% filter(TierID == 83)
pig84 <- mcp %>% filter(TierID == 84)
pig86 <- mcp %>% filter(TierID == 86)
pig97 <- mcp %>% filter(TierID == 97)
pig98 <- mcp %>% filter(TierID == 98)
  
  #Calculate bounding boxes
box1 <- st_bbox(pig1)
box2 <- st_bbox(pig2)
box5 <- st_bbox(pig5)
box10 <- st_bbox(pig10)
box11 <- st_bbox(pig11)
box16 <- st_bbox(pig16)
box18 <- st_bbox(pig18)
box22 <- st_bbox(pig22)
box25 <- st_bbox(pig25)
box31 <- st_bbox(pig31)
box36 <- st_bbox(pig36)
box40 <- st_bbox(pig40) 
box48 <- st_bbox(pig48)
box60 <- st_bbox(pig60)
box83 <- st_bbox(pig83)
box84 <- st_bbox(pig84)
box86 <- st_bbox(pig86)
box97 <- st_bbox(pig97)
box98 <- st_bbox(pig98)

  #calculate area of bounding boxes
area1 <- ((box1$ymax-box1$ymin) * (box1$xmax-box1$xmin))
area2 <- ((box2$ymax-box2$ymin) * (box2$xmax-box2$xmin))
area5 <- ((box5$ymax-box5$ymin) * (box5$xmax-box5$xmin))
area10 <- ((box10$ymax-box10$ymin) * (box10$xmax-box10$xmin))
area11 <- ((box11$ymax-box11$ymin) * (box11$xmax-box11$xmin))
area16 <- ((box16$ymax-box16$ymin) * (box16$xmax-box16$xmin))
area18 <- ((box18$ymax-box18$ymin) * (box18$xmax-box18$xmin))
area22 <- ((box22$ymax-box22$ymin) * (box22$xmax-box22$xmin))
area25 <- ((box25$ymax-box25$ymin) * (box25$xmax-box25$xmin))
area31 <- ((box31$ymax-box31$ymin) * (box31$xmax-box31$xmin))
area36 <- ((box36$ymax-box36$ymin) * (box36$xmax-box36$xmin))
area40 <- ((box40$ymax-box40$ymin) * (box40$xmax-box40$xmin))
area48 <- ((box48$ymax-box48$ymin) * (box48$xmax-box48$xmin))
area60 <- ((box60$ymax-box60$ymin) * (box60$xmax-box60$xmin))
area83 <- ((box83$ymax-box83$ymin) * (box83$xmax-box83$xmin))
area84 <- ((box84$ymax-box84$ymin) * (box84$xmax-box84$xmin))
area86 <- ((box86$ymax-box86$ymin) * (box86$xmax-box86$xmin))
area97 <- ((box97$ymax-box97$ymin) * (box97$xmax-box97$xmin))
area98 <- ((box98$ymax-box98$ymin) * (box98$xmax-box98$xmin))

  #Regroup into data frame
areas <- c(area1, area2, area5, area10, area11, area16, area18, area22, area25, area31, area36, area40, area48, area60, area83, area84, area86, area97, area98 )
namareas <- c("area1", "area2", "area5", "area10", "area11", "area16", "area18", "area22", "area25", "area31", "area36", "area40", "area48", "area60", "area83", "area84", "area86", "area97", "area98")

df <- data.frame(namareas, areas)
df

write.csv(df, file = "boxypigs.csv")
pigs3 <- read.csv("~/Documents/cma_project/SemesterProject_Lizzy/pigareas.csv")

  #Calculate differences by sex
describeBy(pigs3, group = "Sex")
group_by(pigs3, Sex) %>%
  summarise(
    count = n(),
    mean = mean(box_areas, na.rm = TRUE),
    sd = sd(box_areas, na.rm = TRUE)
  )
```

[![Figure 1: Example of a bounding box created from an example set of data. Image from L3Harris Geospatial Solutions, Inc.](images/paste-BA010BFB.png)](https://www.l3harrisgeospatial.com/Learn/Blogs/Blog-Details/ArtMID/10198/ArticleID/15223/Minimum-Area-Bounding-Box)

The second method was an adaptation of the bounding box (chunk 4). The furthest coordinates in each direction were identified and a polygon was created connecting those four points (fig 2). The area was calculated for each pig, and, as with the bounding boxes, the areas were averaged for each sex.

```{r Chunk 3, echo=FALSE}
pig1.1 <- pigs %>% filter(TierID == 1)
pig2.1 <- pigs2 %>% filter(TierID == 1)

ggplot() +
  geom_polygon(pig2.1, mapping=aes(x=E, y=N, fill="Polygon")) +
  geom_point(data=pig1.1, mapping=aes(x=E, y=N))
```

*Figure 2: Ueli's (ID 1) location over the study period, and the resulting polygon created from the for extreme points.*

```{r Chunk 4: Min-Max Polygons}
pigs2 <- read.csv("~/Documents/cma_project/SemesterProject_Lizzy/pigs2.csv")

  #Make data sf
pigs2 <- st_as_sf(pigs2, 
                          coords = c("E", "N"), 
                          crs = 2056,
                          remove = FALSE)

pigs2grouped <- group_by(pigs2,TierID)
pigs2smry <- summarise(pigs2grouped)

polypigs2 <- pigs2smry %>% 
  st_cast("POLYGON")
  
areapigs2 <-  polypigs2 %>%
  mutate(area = st_area(geometry))
areapigs2

write.csv(areapigs2, file = "pigareas.csv")

pigareas <- read.csv("~/Documents/cma_project/SemesterProject_Lizzy/pigareas.csv")

describeBy(pigareas, group = "Sex")
group_by(pigareas, Sex) %>%
  summarise(
    count = n(),
    mean = mean(area, na.rm = TRUE),
    sd = sd(area, na.rm = TRUE)
  )

ggboxplot(pigareas, x = "Sex", y = "area", 
          color = "Sex", palette = c("#aff000", "#00cef6"),
          ylab = "Area", xlab = "Sex")

with(pigareas, shapiro.test(area[Sex == "m"]))
with(pigareas, shapiro.test(area[Sex == "f"]))
  #not normal

wilcox.test(area ~ Sex, data = pigareas,
            exact = FALSE)
```

## Results

```{r Chunk 5, echo=FALSE}
#bounding box method
ggboxplot(pigs3, x = "Sex", y = "box_areas", 
          color = "Sex", palette = c("#aff000", "#00cef6"),
          ylab = "Bounding Box Area", xlab = "Sex")
#Min-max Polygons 
ggboxplot(pigs3, x = "Sex", y = "area", 
          color = "Sex", palette = c("#aff000", "#00cef6"),
          ylab = "Area", xlab = "Sex")
```

Neither method showed statistical differences between the sexes. Using the bounding box, the the average calculated area for males was around 2,734ha while females had an average of 945ha. Using the max-min polygon method, the average calculated area for males was around 588ha, while females had an average of 133ha. These numbers hint at a difference. However, the box plots (fig 3) and the standard deviations (chunk 6) show that the amount of variation negates any possible differences.

```{r Chunk 6}
#Bounding Box Method
group_by(pigs3, Sex) %>%
  summarise(
    count = n(),
    mean = mean(box_areas, na.rm = TRUE),
    sd = sd(box_areas, na.rm = TRUE))

#Min-Max Polygon Method
group_by(pigs3, Sex) %>%
  summarise(
    count = n(),
    mean = mean(area, na.rm = TRUE),
    sd = sd(area, na.rm = TRUE))
```

## Discussion
